# 2.6 VPC Reachability Analyzerë¥¼ í™œìš©í•œ ë„¤íŠ¸ì›Œí¬ ê²½ë¡œ í™•ì¸ ë° ë¬¸ì œ í•´ê²°

> _VPC Reachability Analyzerë¡œ ë„¤íŠ¸ì›Œí¬ ì¸ì‚¬ì´íŠ¸ ê²½ë¡œ ìƒì„± ë° ë¶„ì„_

<img src="https://user-images.githubusercontent.com/70079416/221607249-1889bd35-0cf6-4223-bbbe-e62c20180b17.png" width="60%" height="60%" />

#### â‘  EC2 ì¸ìŠ¤í„´ìŠ¤ì™€ TCP í¬íŠ¸ 22ë¥¼ ì§€ì •í•˜ëŠ” ë„¤íŠ¸ì›Œí¬ ì¸ì‚¬ì´íŠ¸ ê²½ë¡œ ìƒì„±

```bash
INSIGHTS_PATH_ID=$(aws ec2 create-network-insights-path \
	--source $INSTANCE_ID_1 --destination-port 22 \
	--destination $INSTANCE_ID_2 --protocol tcp \
	--output text --query NetworkInsightsPath.NetworkInsightsPathId)
```

#### â‘¡ `INSIGHTS_PATH_ID`ë¥¼ ì‚¬ìš©í•´ ë‘ ì¸ìŠ¤í„´ìŠ¤ ê°„ì˜ ë„¤íŠ¸ì›Œí¬ ì¸ì‚¬ì´íŠ¸ ë¶„ì„ ì‹œì‘ & ê²°ê³¼ í™•ì¸

- ë¶„ì„ ì‹¤í–‰ ê²°ê³¼, `NetworkPathFound: false`, `ENI_SG_RULES_MISMATCH`

```bash
# ë„¤íŠ¸ì›Œí¬ ì¸ì‚¬ì´íŠ¸ ë¶„ì„ ì‹¤í–‰
ANALYSIS_ID_1=$(aws ec2 start-network-insights-analysis \
	--network-insights-path-id $INSIGHTS_PATH_ID --output text \
	--query NetworkInsightsAnalysis.NetworkInsightsAnalysisId)

# ì‹¤í–‰ ì™„ë£Œë˜ë©´ ê²°ê³¼ í™•ì¸
aws ec2 describe-network-insights-analyses \
	--network-insights-analysis-ids $ANALYSIS_ID_1
```

<img src="https://user-images.githubusercontent.com/70079416/221607224-61147395-b6fc-446e-86ba-7bf62a92bf99.png" width="60%" height="60%" />
<img src="https://user-images.githubusercontent.com/70079416/221607240-e59376b9-a4f9-4ccb-b354-0ac2e09104ec.png" width="60%" height="60%" />

#### â‘¢ ì¸ìŠ¤í„´ìŠ¤2ì˜ ë³´ì•ˆ ê·¸ë£¹ ì—…ë°ì´íŠ¸í•˜ê³  ì¸ì‚¬ì´íŠ¸ ë¶„ì„ ì¬ì‹¤í–‰ & ê²°ê³¼ í™•ì¸

- ë³´ì•ˆ ê·¸ë£¹ ì—…ë°ì´íŠ¸ í›„ ë¶„ì„ ì‹¤í–‰ ê²°ê³¼, `NetworkPathFound: true`

```bash
# ì¸ìŠ¤í„´ìŠ¤2ì˜ ë³´ì•ˆ ê·¸ë£¹: ì¸ìŠ¤í„´ìŠ¤1ì˜ ë³´ì•ˆ ê·¸ë£¹ì—ì„œ TCP í¬íŠ¸ 22ë¡œì˜ ì•¡ì„¸ìŠ¤ í—ˆìš© ê·œì¹™ ì¶”ê°€
aws ec2 authorize-security-group-ingress \
	--protocol tcp --port 22 \
	--source-group $INSTANCE_SG_ID_1 \
	--group-id $INSTANCE_SG_ID_2

# ë„¤íŠ¸ì›Œí¬ ì¸ì‚¬ì´íŠ¸ ë¶„ì„ ì‹¤í–‰; ANALYSIS_ID_2
ANALYSIS_ID_2=$(aws ec2 start-network-insights-analysis \
	--network-insights-path-id $INSIGHTS_PATH_ID --output text \
	--query NetworkInsightsAnalysis.NetworkInsightsAnalysisId)

# ì‹¤í–‰ ì™„ë£Œë˜ë©´ ê²°ê³¼ í™•ì¸
aws ec2 describe-network-insights-analyses \
	--network-insights-analysis-ids $ANALYSIS_ID_2
```

<img src="https://user-images.githubusercontent.com/70079416/221607244-65d066d3-4950-429a-a792-0d006a23bc11.png" width="60%" height="60%" />

---

**ğŸ¥•Â ì°¸ê³ **

â¢ **VPC Reachability Analyzer**

- ì¸í”„ë¼ í”„ë¡œë¹„ì €ë‹í•  í•„ìš” ì—†ì´ ì„œë²„ë¦¬ìŠ¤ ë°©ì‹ìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ í•´ê²° ë° êµ¬ì„±ì˜ ìœ íš¨ì„± ê²€ì¦
- ë„¤íŠ¸ì›Œí¬ ê²½ë¡œ ë¶„ì„ ê²°ê³¼ ì„¤ëª… ì½”ë“œ ë°˜í™˜
