# 2.5 ë³´ì•ˆ ê·¸ë£¹ì„ ì°¸ê³ í•´ ë™ì ìœ¼ë¡œ ì ‘ê·¼ ê¶Œí•œ ë¶€ì—¬

> 2ê°œì˜ ì¸ìŠ¤í„´ìŠ¤ë¡œ êµ¬ì„±í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ê·¸ë£¹ ì‚¬ì´ì— SSH í—ˆìš©

- ì—¬ëŸ¬ EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ ENIì— ë™ì¼í•œ ë³´ì•ˆ ê·¸ë£¹ì„ ì ìš©í•´ë„ ì´ë“¤ ê°„ í†µì‹ ì€ ë¶ˆê°€ëŠ¥í•¨

#### â‘  EC2 ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•œ ìƒˆ ë³´ì•ˆ ê·¸ë£¹ ìƒì„±

```bash
SG_ID=$(aws ec2 create-security-group \
	--group-name AWSCookbook205Sg \
	--description "Instance Security Group" --vpc-id $VPC_ID \
	--output text --query GroupId)
```

#### â‘¡ ë³´ì•ˆ ê·¸ë£¹ì„ ë‘ ì¸ìŠ¤í„´ìŠ¤(`INSTANCE_ID_1`, `INSTANCE_ID_2`)ì— ì—°ê²°

```bash
aws ec2 modify-instance-attribute --instance-id $INSTANCE_ID_1 \
	--groups $SG_ID

aws ec2 modify-instance-attribute --instance-id $INSTANCE_ID_2 \
	--groups $SG_ID
```

```bash
# ENIì— ì—°ê²°ëœ ë³´ì•ˆ ê·¸ë£¹ í™•ì¸
aws ec2 describe-security-groups --group-ids \
	$(aws ec2 describe-instances --instance-id $INSTANCE_ID_1 \
	--query "Reservations[].Instances[].SecurityGroups[].GroupId[]" \
	--output text) --output text
```

#### â‘¢ TCP í¬íŠ¸ 22ë¡œì˜ ì•¡ì„¸ìŠ¤ë¥¼ í—ˆìš©í•˜ëŠ” ì¸ë°”ìš´ë“œ ê·œì¹™ ì¶”ê°€

```bash
aws ec2 authorize-security-group-ingress \
	--protocol tcp --port 22 \
	--source-group $SG_ID \
	--group-id $SG_ID
```

---

**ğŸ¥•Â ìœ íš¨ì„± ê²€ì‚¬** : ì¸ìŠ¤í„´ìŠ¤1ì—ì„œ ì¸ìŠ¤í„´ìŠ¤2ë¡œì˜ ì—°ê²° í™•ì¸

```bash
# ì¸ìŠ¤í„´ìŠ¤ 2ì˜ private IP í™•ì¸
INSTANCE_IP_2=$(aws ec2 describe-instances --instance-ids $INSTANCE_ID_2 \
	--output text \
	--query Reservations[0].Instances[0].PrivateIpAddress)

# SSM ì„¸ì…˜ ê´€ë¦¬ìë¡œ ì¸ìŠ¤í„´ìŠ¤1 ì—°ê²°
aws ssm start-session --target $INSTANCE_ID_1

# Ncat(netcat): ì†Œì¼“ í†µì‹ , ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ ìœ„í•œ ë°±ì—”ë“œ ë„êµ¬
sudo yum -y install nc

# ì¸ìŠ¤í„´ìŠ¤2ì— ëŒ€í•œ SSH ì—°ê²° í…ŒìŠ¤íŠ¸
nc -vz $INSTANCE_IP_2 22
```

**ğŸ¥•Â ì°¸ê³ **

â¢ ë³´ì•ˆ ê·¸ë£¹ì€ ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë“  ì†¡ì‹  í—ˆìš©, ëª¨ë“  ìˆ˜ì‹  ì•”ë¬µì  ì°¨ë‹¨

- ì—¬ëŸ¬ ë³´ì•ˆ ê·¸ë£¹ì„ í•˜ë‚˜ì˜ ENIì— ì—°ê²°í•  ìˆ˜ ìˆìŒ
